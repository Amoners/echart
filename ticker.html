<!DOCTYPE html>
<head>
    <meta charset="utf-8">
    <title>ECharts</title>
</head>
<body>
    <!-- 为ECharts准备一个具备大小（宽高）的Dom -->
    <div id="main" style="height:800px"></div>
    <!-- ECharts单文件引入 -->
    <script src="http://echarts.baidu.com/build/dist/echarts-all.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" crossorigin="anonymous"></script>
    <script type="text/javascript">
        var app = {
            createChart_day: function(datajson){
                var myChart = echarts.init(document.getElementById('main'));
                var xAxisData = [];
                var combineData = [];
                datajson.forEach((v) => {
                    xAxisData.push(v[1]);
                    // var arr = new Array()
                    // arr.push(v[2]);
                    // arr.push(v[3]);
                    // arr.push(v[5]);
                    // arr.push(v[4]);
                    // combineData.push(arr.join());
                }
                )
                //console.log(combineData);
                xAxisData.sort();
                var option = {
                    title: {
                      text: 'Bitcoin History Data'
                    },
                    tooltip: {
                        trigger: 'axis',
                        showDelay: 0,
                        formatter: function(params){
                                       var res = params[0].name;
            res += '<br/>' + params[0].seriesName;
            res += '<br/>  开盘 : ' + params[0].value[0] + '  最高 : ' + params[0].value[3];
            res += '<br/>  收盘 : ' + params[0].value[1] + '  最低 : ' + params[0].value[2];
            return res;

                        }
                    },
                    legend: {
                        data: ['history', 'price', 'volume']
                    },
                    // toolbox: {
                    //     show : true,
                    //     feature : {
                    //         mark : {show: true},
                    //         dataZoom : {show: true},
                    //         magicType : {show: true, type: ['line', 'bar']},
                    //         restore : {show: true},
                    //         saveAsImage : {show: true}
                    //     }
                    // },
                    dataZoom : {
                        y: 250,
                        show : true,
                        realtime: true,
                        start : 50,
                        end : 100
                    },
                    grid: {
                        x: 80,
                        y: 40,
                        x2:20,
                        y2:25
                    },
                    xAxis: [
                        {
                            type: 'category',
                            boundaryGap : true,
                            axisTick: {onGap:false},
                            splitLine: {show:false},
                            data: xAxisData
                        }
                    ],
                    yAxis: [
                        {
                            type: 'value',
                            scale:true,
                            boundaryGap: [0.01, 0.01],
                            splitArea : {show : true}
                        }
                    ],
                    series: [
                        {
                            "name": "history",
                            "type": "k",
                            // "data": combineData
                            "data": [
                                [6730.21, 6329.95,6320.72,6767.74],
                                [6775.08,6741.75,6724.34,6838.68]
                            ]
                        }
                    ]
                };
                // 为echarts对象加载数
                myChart.setOption(option);

            },


        ajxUrlMap:{
            day_url: 'http://47.75.103.110:5000/dv_coinmarket_history/symbol=bitcoin',
            price_url: 'http://47.75.103.110:5000/dv_coinmarket_history/symbol=bitcoin'
        },

        fetchChartTicker_day(req_url)
        {
            $.ajax({
                url: req_url,
                success: function (res) {
                    app.createChart_day(res);

                },
                error: function (err) {
                }
            });
        }
        }
        app.fetchChartTicker_day("http://47.75.103.110:5000/dv_coinmarket_history/symbol=bitcoin&limit=2");
    </script>
</body>